<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function requires the mvtnorm package."><title>Train Similarity Based Probability Model with anonymized training data — train_similarity_based_reasoning • occupationMeasurement</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Train Similarity Based Probability Model with anonymized training data — train_similarity_based_reasoning"><meta property="og:description" content="This function requires the mvtnorm package."><meta property="og:image" content="https://occupationmeasurement.github.io/occupationMeasurement/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">occupationMeasurement</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/occupationMeasurement.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/app.html">Using the Interactive App</a>
    <a class="dropdown-item" href="../articles/app-questionnaire.html">Custom Questionnaires / Pages</a>
    <a class="dropdown-item" href="../articles/app-database.html">Saving App Data in a Database</a>
    <a class="dropdown-item" href="../articles/app-deployment.html">Deploying to a Server / the Cloud</a>
    <a class="dropdown-item" href="../articles/api.html">Using the API</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/occupationMeasurement/occupationMeasurement/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Train Similarity Based Probability Model with anonymized training data</h1>
      <small class="dont-index">Source: <a href="https://github.com/occupationMeasurement/occupationMeasurement/blob/HEAD/R/model_training.R" class="external-link"><code>R/model_training.R</code></a></small>
      <div class="d-none name"><code>train_similarity_based_reasoning.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function requires the mvtnorm package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">train_similarity_based_reasoning</span><span class="op">(</span></span>
<span>  <span class="va">anonymized_data</span>,</span>
<span>  num_allowed_codes <span class="op">=</span> <span class="fl">1291</span>,</span>
<span>  <span class="va">coding_index_w_codes</span>,</span>
<span>  coding_index_without_codes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preprocessing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>stopwords <span class="op">=</span> <span class="cn">NULL</span>, stemming <span class="op">=</span> <span class="cn">NULL</span>, strPreprocessing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    removePunct <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  dist_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wordwise"</span>, <span class="st">"substring"</span>, <span class="st">"fulltext"</span><span class="op">)</span>,</span>
<span>  dist_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"osa"</span>, weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>d <span class="op">=</span> <span class="fl">1</span>, i <span class="op">=</span> <span class="fl">1</span>, s <span class="op">=</span> <span class="fl">1</span>, t <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>max <span class="op">=</span> <span class="fl">3</span>, use <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  simulation_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n.draws <span class="op">=</span> <span class="fl">250</span>, check_normality <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>anonymized_data</dt>
<dd><p><code>surveyCountsSubstringSimilarity</code> or <code>surveyCountsWordwiseSimilarity</code></p></dd>


<dt>num_allowed_codes</dt>
<dd><p>the number of allowed codes in the target classification. There are 1286 categories in the KldB 2010 plus 5 special codes in both anonymized training data sets, so the default value is 1291.</p></dd>


<dt>coding_index_w_codes</dt>
<dd><p>a data.table with columns</p><dl><dt>bezMale</dt>
<dd><p>a character vector, contains masculine job titles from the coding index.</p></dd>

<dt>bezFemale</dt>
<dd><p>a character vector, contains feminine job titles from the coding index.</p></dd>

<dt>Code</dt>
<dd><p>a character vector with associated classification codes.</p></dd>


</dl></dd>


<dt>coding_index_without_codes</dt>
<dd><p>(not used, but automatically determined) Any words from <code>anonymized_data$dictString</code> that are not found within <code>coding_index_w_codes</code> belong into this character vector.</p></dd>


<dt>preprocessing</dt>
<dd><p>a list with elements</p><dl><dt>stopwords</dt>
<dd><p>a character vector, use <code>tm::stopwords("de")</code> for German stopwords. Only used if <code>dist_type = "wordwise"</code>.</p></dd>

<dt>stemming</dt>
<dd><p><code>NULL</code> for no stemming and <code>"de"</code> for stemming using the German porter stemmer. Do not use unless the job titles in <code>coding_index_w_codes</code> were stemmed.</p></dd>

<dt>strPreprocessing</dt>
<dd><p><code>TRUE</code> if <code><a href="preprocess_string.html">preprocess_string</a></code> shall be used.</p></dd>

<dt>removePunct</dt>
<dd><p><code>TRUE</code> if <code><a href="https://rdrr.io/pkg/tm/man/removePunctuation.html" class="external-link">removePunctuation</a></code> shall be used.</p></dd>


</dl></dd>


<dt>dist_type</dt>
<dd><p>How to calculate similarity between entries from both coding_indices and verbal answers from the survey? Three options are currently supported.  Since we use the <code><a href="https://rdrr.io/pkg/stringdist/man/stringdist.html" class="external-link">stringdist</a></code>-function excessively, one could easily extend the functionality of this procedure to other distance metrics.</p><dl><dt>dist_type = "fulltext"</dt>
<dd><p>Uses the <code><a href="https://rdrr.io/pkg/stringdist/man/stringdist.html" class="external-link">stringdist</a></code>-function directly after preprocessing to calculate distances. (the simplest approach but least useful.)</p></dd>

<dt>dist_type = "substring"</dt>
<dd><p>An entry from the coding index and a verbal answer are similar if the entry from the coding index is a substring of the verbal answer.</p></dd>

<dt>dist_type = "wordwise"</dt>
<dd><p>After preprocessing, split the verbal answer into words. Then calculate for each word separately the the similarity with entries from the coding index, using <code><a href="https://rdrr.io/pkg/stringdist/man/stringdist.html" class="external-link">stringdist</a></code>. Not the complete verbal answer but only the words (0 or more) that have highest similarity are then used to determine similarity with entries from the coding index.</p></dd>


</dl></dd>


<dt>dist_control</dt>
<dd><p>If <code>dist_type = "fulltext"</code> or <code>dist_type = "wordwise"</code> the entries from this list will be passed to <code><a href="https://rdrr.io/pkg/stringdist/man/stringdist.html" class="external-link">stringdist</a></code>. Currently only two possible entries are supported (method = "osa", weight = c(d = 1, i = 1, s = 1, t = 1) is recommended), but one could easily extend the functionality.</p></dd>


<dt>threshold</dt>
<dd><p>A numeric vector with two elements. If <code>dist_type = "fulltext"</code> or <code>dist_type = "wordwise"</code>, the threshold determines up to which distance a verbal answer and an entry from the coding index are similar. The second number actually gets used. The first number is only used to speed up similarity calculations. It should be identical or larger than the second number.</p></dd>


<dt>simulation_control</dt>
<dd><p>a list with two components,</p><dl><dt>n.draws</dt>
<dd><p>Number of draws from the posterior distribution to determine posterior predictive probabilities. The larger, the more precise the results will be.</p></dd>

<dt>check_normality</dt>
<dd><p>We would like that the hyperprior distribution is normal. Set check_normality to TRUE to do some diagnostics about this.</p></dd>


</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a list with components</p><dl><dt>prediction.datasets$modelProb</dt>
<dd><p>Contains all entries from the coding index. dist = "official" if the entry stems from coding_index_w_codes and dist = selfcreated if the entry stems from coding_index_without_codes. <code>string.prob</code> is used for weighting purposes (model averaging) if a new verbal answer is similar to multiple strings. <code>unobserved.mean.theta</code> gives a probability (usually very low) for any category that was not observed in the training data together with this string.</p></dd>

<dt>prediction.datasets$categoryProb</dt>
<dd><p><code>mean.theta</code> is the probability for <code>code</code> given that an incoming verbal answer is similar to <code>string</code>. Only available if this code was at least a single time observed with this string (Use <code>unobserved.mean.theta</code> otherwise).</p></dd>

<dt>num_allowed_codes</dt>
<dd><p>Number of categories in the classification.</p></dd>

<dt>preprocessing</dt>
<dd><p>The input parameter stored to replicate preprocessing with incoming data.</p></dd>

<dt>dist_type</dt>
<dd><p>The input parameter stored to replicate distance calculations with incoming data.</p></dd>

<dt>dist_control</dt>
<dd><p>The input parameter stored to replicate distance calculations with incoming data.</p></dd>

<dt>threshold</dt>
<dd><p>The input parameter stored to replicate distance calculations with incoming data.</p></dd>

<dt>simulation_control</dt>
<dd><p>The input parameters controlling the Monte Carlo simulation.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Schierholz, Malte (2019): New methods for job and occupation classification. Dissertation, Mannheim. <a href="https://madoc.bib.uni-mannheim.de/50617/" class="external-link">https://madoc.bib.uni-mannheim.de/50617/</a>, pp. 206-208 and p. 268, pp. 308-320</p>
<p><a href="https://github.com/malsch/occupationCoding" class="external-link">https://github.com/malsch/occupationCoding</a> (function trainSimilarityBasedReasoning2 is implemented here)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="pretrained_models.html">pretrained_models</a>, which were created using this function.</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jan Simson, Olga Kononykhina, Malte Schierholz.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

